# ==================== PROFILE CONFIGURATION ====================
spring.profiles.active=dev

# ==================== SERVER CONFIGURATION ====================
server.port=8080
server.error.include-message=always
server.error.include-binding-errors=always
server.servlet.context-path=/

# ==================== DATABASE CONFIGURATION ====================
spring.datasource.url=jdbc:mysql://localhost:3306/travel_planner_app_db?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
spring.datasource.username=${DB_USERNAME:root}
spring.datasource.password=${DB_PASSWORD:}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000

# ==================== JPA/HIBERNATE CONFIGURATION ====================
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true
spring.jpa.properties.hibernate.jdbc.batch_size=20

# ==================== APPLICATION CONFIGURATION ====================
spring.application.name=travel-planner-backend

# ==================== SPRING MVC CONFIGURATION ====================
spring.mvc.pathmatch.matching-strategy=ant_path_matcher

# ==================== JWT CONFIGURATION ====================
jwt.secret-key=${JWT_SECRET_KEY:}
jwt.expiration-ms=86400000
jwt.issuer=travel-planner-app
jwt.refresh-expiration-ms=604800000
jwt.algorithm=HS256

# ==================== LOGGING CONFIGURATION ====================
logging.level.org.springframework=INFO
logging.level.com.travelplanner=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.file.name=logs/travel-planner.log
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ==================== SCHEDULER CONFIGURATION ====================
spring.task.scheduling.pool.size=10

# ==================== NOTIFICATION SETTINGS ====================
notification.default.quiet-hours-start=22
notification.default.quiet-hours-end=7
notification.flight-check-interval=60
notification.weather-check-interval=360

# ==================== OFFLINE/CACHE CONFIGURATION ====================
offline.cache.expiration-days=7
offline.cache.cleanup-enabled=true
offline.export.expiration-hours=24
offline.sync.conflict-resolution=SERVER_WINS # SERVER_WINS, CLIENT_WINS, MANUAL

# ==================== RATE LIMITING CONFIGURATION ====================
rate.limit.auth=5
rate.limit.auth.window-minutes=1
rate.limit.admin=100
rate.limit.admin.window-minutes=1
rate.limit.default=60
rate.limit.default.window-minutes=1
rate.limit.burst-multiplier=2

# ==================== EXTERNAL API CONFIGURATION ====================
external.api.flight.provider=amadeus
external.api.flight.base-url=${FLIGHT_API_URL:https://test.api.amadeus.com}
external.api.flight.api-key=${FLIGHT_API_KEY:}
external.api.flight.api-secret=${FLIGHT_API_SECRET:}
external.api.flight.timeout-ms=10000
external.api.flight.max-retries=3

external.api.weather.provider=openweather
external.api.weather.base-url=${WEATHER_API_URL:https://api.openweathermap.org/data/2.5}
external.api.weather.api-key=${WEATHER_API_KEY:}
external.api.weather.timeout-ms=5000
external.api.weather.units=metric

external.api.maps.provider=google
external.api.maps.base-url=${MAPS_API_URL:https://maps.googleapis.com/maps/api}
external.api.maps.api-key=${MAPS_API_KEY:}
external.api.maps.timeout-ms=5000

# ==================== CORS CONFIGURATION ====================
app.cors.allowed-origins=http://localhost:5173,http://localhost:8080,https://travelplanner.com
app.cors.max-age=3600

# ==================== TOKEN BLACKLIST CONFIGURATION ====================
app.token.blacklist.default-expiry-hours=24
app.token.blacklist.cleanup-batch-size=1000

# ==================== RESILIENCE4J CONFIGURATION ====================
resilience4j.ratelimiter.instances.auth-api.limit-for-period=${rate.limit.auth}
resilience4j.ratelimiter.instances.auth-api.limit-refresh-period=${rate.limit.auth.window-minutes}m
resilience4j.ratelimiter.instances.auth-api.timeout-duration=2s

resilience4j.ratelimiter.instances.admin-api.limit-for-period=${rate.limit.admin}
resilience4j.ratelimiter.instances.admin-api.limit-refresh-period=${rate.limit.admin.window-minutes}m
resilience4j.ratelimiter.instances.admin-api.timeout-duration=2s

resilience4j.ratelimiter.instances.default-api.limit-for-period=${rate.limit.default}
resilience4j.ratelimiter.instances.default-api.limit-refresh-period=${rate.limit.default.window-minutes}m
resilience4j.ratelimiter.instances.default-api.timeout-duration=2s

resilience4j.circuitbreaker.instances.external-api.sliding-window-size=10
resilience4j.circuitbreaker.instances.external-api.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.external-api.wait-duration-in-open-state=60s

resilience4j.retry.instances.external-api.max-attempts=3
resilience4j.retry.instances.external-api.wait-duration=1s